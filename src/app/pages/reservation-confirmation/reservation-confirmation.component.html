<div class="confirmation-container">
  <div *ngIf="isLoading" class="text-center">
    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;"></div>
    <p class="mt-2 lead">Po ngarkohen detajet e rezervimit...</p>
  </div>

  <div *ngIf="!isLoading" class="card confirmation-card">
    <div class="card-body">
      <div *ngIf="status !== 'NOT_FOUND'" class="">
        <div class="text-center bg-light">
          <i class="confirmation-icon"
             [ngClass]="{
               'bi bi-check-circle-fill text-success': status === 'CONFIRMED',
               'bi bi-x-circle-fill text-danger': status === 'CANCELED',
               'bi bi-hourglass-split text-warning': status === 'PENDING_APPROVAL'
             }"
             style="font-size: 3rem;"></i>

          <h2 *ngIf="status === 'CONFIRMED'" class="mt-3 fw-bold text-success">Rezervimi u Konfirmua!</h2>
          <h2 *ngIf="status === 'CANCELED'" class="mt-3 fw-bold text-danger">Rezervimi u Anullua</h2>
          <h2 *ngIf="status === 'PENDING_APPROVAL'" class="mt-3 fw-bold text-warning">Kërkesa u Pranua</h2>

          <p *ngIf="status === 'CONFIRMED'" class="lead text-muted">
            Faleminderit për rezervimin. Ju mund të shikoni detajet më poshtë.
          </p>
          <p *ngIf="status === 'CANCELED'" class="lead text-muted">
            {{ cancellationMessage || 'Rezervimi juaj është anulluar.' }}
          </p>
          <p *ngIf="status === 'PENDING_APPROVAL'" class="lead text-muted">
            Kërkesa juaj është në pritje të aprovimit. Do të njoftoheni me email pasi të shqyrtohet.
          </p>
        </div>

        <div *ngIf="reservationDetails" class="mt-4">
          <div class="row">
            <div class="col-md-6">
              <div>
                <p class="mb-1">ID e Rezervimit :</p>
                <h5 class="font-size-16">{{ reservationDetails.id }}</h5>
              </div>
              <div class="mt-4">
                <p class="mb-1">Data :</p>
                <h5 class="font-size-16">{{ formattedDate }}</h5>
              </div>
              <div class="mt-4">
                <p class="mb-1">Koha :</p>
                <h5 class="font-size-16">{{ formattedTime }}</h5>
              </div>
              <div class="mt-4">
                <p class="mb-1">Numri i Personave :</p>
                <h5 class="font-size-16">{{ formattedGuests }}</h5>
              </div>
              <div class="mt-4">
                <p class="mb-1">Kërkesa Speciale :</p>
                <h5 class="font-size-16">{{ requests || '-' }}</h5>
              </div>
            </div>
            <div class="col-md-6">
              <div>
                <p class="mb-1">Zona :</p>
                <h5 class="font-size-16">{{ selectedZone }}</h5>
              </div>
              <div class="mt-4">
                <p class="mb-1">Emri :</p>
                <h5 class="font-size-16">{{ fullName }}</h5>
              </div>
              <div class="mt-4">
                <p class="mb-1">Email :</p>
                <h5 class="font-size-16">{{ email }}</h5>
              </div>
              <div class="mt-4">
                <p class="mb-1">Telefoni :</p>
                <h5 class="font-size-16">{{ phone }}</h5>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-4 my-auto bg-light d-flex justify-content-between align-items-center p-3">
          <button *ngIf="status === 'CONFIRMED' || status === 'PENDING_APPROVAL'"
                  class="btn btn-outline-danger waves-effect waves-light w-md"
                  (click)="cancelReservation()">
            {{ status === 'PENDING_APPROVAL' ? 'Anullo Kërkesën' : 'Anullo' }}
          </button>
          <button class="btn btn-primary waves-effect waves-light w-md" (click)="goBack()">
            Kthehu
          </button>
        </div>
      </div>

      <div *ngIf="status === 'NOT_FOUND'">
        <i class="uil uil-exclamation-triangle confirmation-icon error"></i>
        <h2 class="mt-3">Rezervimi Nuk U Gjet</h2>
        <p class="lead">Linku që keni përdorur mund të jetë i pavlefshëm ose i skaduar. Ju lutemi kontrolloni email-in tuaj ose kontaktoni restorantin drejtpërdrejt.</p>
        <button class="btn btn-primary mt-4" (click)="goBack()">Kthehu</button>
      </div>
    </div>
  </div>

  <div class="modal-backdrop fade show" *ngIf="showConfirmModal"></div>
  <div class="modal fade" id="confirmCancelModal" tabindex="-1" aria-labelledby="confirmCancelModalLabel" aria-hidden="true" [class.show]="showConfirmModal" [style.display]="showConfirmModal ? 'block' : 'none'">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="confirmCancelModalLabel">Konfirmo Anullimin</h5>
          <button type="button" class="btn-close" (click)="closeModal()" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Jeni i sigurt që dëshironi të anuloni rezervimin tuaj?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="closeModal()">Anullo</button>
          <button type="button" class="btn btn-danger" (click)="confirmCancellation()">Konfirmo</button>
        </div>
      </div>
    </div>
  </div>
</div>
